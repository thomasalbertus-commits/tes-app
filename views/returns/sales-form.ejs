<div class="max-w-3xl mx-auto">
  <form method="POST" action="/return-sales">
    <div class="space-y-6">
      <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
        <h3 class="font-bold text-slate-800 mb-4">Info Retur</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <div>
            <label class="block text-sm font-semibold mb-1">Ref. Penjualan</label>
            <select name="sale_id" class="w-full px-4 py-2.5 border border-slate-300 rounded-xl text-sm">
              <option value="">-- Tidak Ada --</option>
              <% sales.forEach(s => { %><option value="<%= s.id %>">#<%= s.id %> - <%= s.customer_name || 'Umum' %> (<%= formatCurrency(s.total) %>)</option><% }) %>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-1">Alasan</label>
            <input type="text" name="reason" class="w-full px-4 py-2.5 border border-slate-300 rounded-xl text-sm" placeholder="Alasan retur">
          </div>
          <div>
            <label class="block text-sm font-semibold mb-1">Kompensasi (Rp)</label>
            <input type="number" name="compensation" value="0" class="w-full px-4 py-2.5 border border-slate-300 rounded-xl text-sm">
          </div>
          <div>
            <label class="block text-sm font-semibold mb-1">Akun Kas</label>
            <select name="cash_account_id" class="w-full px-4 py-2.5 border border-slate-300 rounded-xl text-sm">
              <option value="">-- Tidak Ada --</option>
              <% cashAccounts.forEach(a => { %><option value="<%= a.id %>"><%= a.name %></option><% }) %>
            </select>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-bold text-slate-800">Item Retur</h3>
          <button type="button" onclick="addReturnItem()" class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-bold">+ Tambah</button>
        </div>
        <div id="returnItems" class="space-y-3"></div>
      </div>

      <div class="flex gap-3">
        <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700">Simpan Retur</button>
        <a href="/return-sales" class="px-6 py-3 bg-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-300">Batal</a>
      </div>
    </div>
  </form>
</div>

<script>
let ri = 0;
function addReturnItem() {
  document.getElementById('returnItems').insertAdjacentHTML('beforeend', `
    <div class="ri-row grid grid-cols-3 gap-2 p-3 bg-slate-50 rounded-xl animate-fade-in">
      <input type="text" name="items[${ri}][name]" placeholder="Nama Item" class="px-3 py-2 border border-slate-300 rounded-lg text-sm" required>
      <input type="number" name="items[${ri}][qty]" value="1" min="1" class="px-3 py-2 border border-slate-300 rounded-lg text-sm">
      <div class="flex gap-2">
        <input type="number" name="items[${ri}][price]" placeholder="Harga" class="px-3 py-2 border border-slate-300 rounded-lg text-sm flex-1">
        <button type="button" onclick="this.closest('.ri-row').remove()" class="p-2 text-red-500 hover:bg-red-50 rounded-lg">&times;</button>
      </div>
    </div>`);
  ri++;
}
addReturnItem();
</script>
